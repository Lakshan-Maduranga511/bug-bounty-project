# Vulnerability Report: Local File Inclusion (LFI)

## Executive Summary
A Local File Inclusion (LFI) vulnerability allows attackers to read arbitrary files from the web server, including system files and configuration files containing sensitive credentials.

## Vulnerability Details

**Severity**: High (CVSS 7.5)
**Type**: Local File Inclusion (LFI) / Path Traversal
**Location**: http://localhost/vulnerabilities/fi/
**Parameter**: page (GET)
**CWE**: CWE-22 (Improper Limitation of a Pathname to a Restricted Directory)
**Date Discovered**: 2026-01-16
**Discovered By**: Lakshan

## Description
The file inclusion functionality does not properly validate the 'page' parameter, allowing directory traversal attacks. Attackers can use `../` sequences to navigate to parent directories and read any file accessible to the web server process.

## Proof of Concept

### Step-by-Step Reproduction:
1. Navigate to: http://localhost/vulnerabilities/fi/
2. Observe normal URL: `?page=include.php`
3. Modify URL to: `?page=../../../../etc/passwd`
4. Press Enter
5. Observe system password file contents displayed

### Successful Payloads:

**Payload 1: Read /etc/passwd**
```
http://localhost/vulnerabilities/fi/?page=../../../../etc/passwd
```
Result: ✓ System user accounts enumerated

**Payload 2: PHP Filter Wrapper**
```
http://localhost/vulnerabilities/fi/?page=php://filter/convert.base64-encode/resource=include.php
```
Result: ✓ Source code exposed in base64

### Screenshots:
![LFI /etc/passwd](../screenshots/idor/lfi-passwd-success.png)
![Burp Suite Testing](../screenshots/idor/burp-lfi-success.png)

## Impact Analysis

### CVSS v3.1 Score: 7.5 (HIGH)

**Impact:**
- Read sensitive system files
- Expose database credentials
- View application source code
- Potential for remote code execution

### Attack Scenario:
1. Read configuration files
2. Extract database credentials
3. Connect directly to database
4. Full data breach

## Remediation

**1. Whitelist Approach**
```php
<?php
$allowed = ['file1.php', 'file2.php', 'file3.php'];
if (in_array($_GET['page'], $allowed)) {
    include($_GET['page']);
} else {
    die("Access Denied");
}
?>
```

**2. Path Validation**
```php
<?php
$base = '/var/www/html/includes/';
$file = realpath($base . basename($_GET['page']));
if (strpos($file, $base) === 0 && file_exists($file)) {
    include($file);
}
?>
```

### Priority: HIGH
**Timeline**: Fix within 7 days

## Report Information
- **Discovered by**: Lakshan
- **Date**: 2026-01-16
- **Application**: DVWA v1.10